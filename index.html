<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta F√°cil Sa√∫de</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'health-green': '#22C55E',
                        'health-blue': '#3B82F6',
                        'health-light-blue': '#E0F2FE',
                        'health-dark-green': '#16A34A',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen bg-gradient-to-br from-health-blue to-health-green flex items-center justify-center px-4">
        <div class="max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-gradient-to-r from-health-green to-health-blue rounded-lg flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Consulta F√°cil Sa√∫de</h2>
                <p class="text-gray-600 dark:text-gray-400 mt-2">Acesse sua conta para continuar</p>
            </div>

            <form onsubmit="performLogin(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email ou CPF</label>
                    <input type="text" id="loginEmail" placeholder="email@exemplo.com ou 123.456.789-00" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Senha</label>
                    <input type="password" id="loginPassword" placeholder="Digite sua senha" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo de Usu√°rio</label>
                    <select id="userType" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white" required>
                        <option value="">Selecione seu perfil</option>
                        <option value="patient">üë§ Paciente</option>
                        <option value="doctor">üë®‚Äç‚öïÔ∏è M√©dico</option>
                        <option value="health_unit">üè• Unidade de Sa√∫de</option>
                        <option value="admin">üë• Administrador</option>
                    </select>
                </div>

                <button type="submit" class="w-full bg-health-green text-white py-3 rounded-md hover:bg-health-dark-green transition-colors font-medium">
                    Entrar
                </button>
            </form>

            <div class="mt-6 border-t border-gray-200 dark:border-gray-700 pt-6">
                <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Acesso R√°pido (Demo)</h3>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="quickLogin('patient')" class="text-xs bg-blue-50 text-blue-700 py-2 px-3 rounded hover:bg-blue-100 transition-colors">
                        üë§ Paciente
                    </button>
                    <button onclick="quickLogin('doctor')" class="text-xs bg-green-50 text-green-700 py-2 px-3 rounded hover:bg-green-100 transition-colors">
                        üë®‚Äç‚öïÔ∏è M√©dico
                    </button>
                    <button onclick="quickLogin('health_unit')" class="text-xs bg-teal-50 text-teal-700 py-2 px-3 rounded hover:bg-teal-100 transition-colors">
                        üè• Unidade
                    </button>
                    <button onclick="quickLogin('admin')" class="text-xs bg-purple-50 text-purple-700 py-2 px-3 rounded hover:bg-purple-100 transition-colors">
                        üë• Admin
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header id="mainHeader" class="hidden bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-r from-health-green to-health-blue rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h1 class="text-xl font-bold text-gray-900 dark:text-white">Consulta F√°cil Sa√∫de</h1>
                        <p class="text-xs text-gray-500 dark:text-gray-400" id="userInfo">Carregando...</p>
                    </div>
                </div>
                <nav class="hidden md:flex space-x-6" id="mainNavigation">
                    <!-- Navigation will be populated based on user type -->
                </nav>
                <div class="flex items-center gap-3">
                    <div class="hidden md:flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400">
                        <span id="currentUserName">Usu√°rio</span>
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full" id="currentUserType">Tipo</span>
                    </div>
                    <button onclick="logout()" class="text-red-600 hover:text-red-800 text-sm font-medium">
                        Sair
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main id="mainContent" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Home Section -->
        <section id="homeSection" class="section fade-in">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Bem-vindo ao Sistema de Sa√∫de P√∫blica</h2>
                <p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
                    Agende suas consultas, acompanhe sua posi√ß√£o na fila e gerencie seu hist√≥rico m√©dico de forma simples e eficiente.
                </p>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-health-green rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <h3 class="ml-3 text-lg font-semibold text-gray-900 dark:text-white">Agendar Consulta</h3>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Marque uma nova consulta com especialistas da rede p√∫blica</p>
                    <button onclick="showSection('appointments')" class="w-full bg-health-green text-white py-2 rounded-md hover:bg-health-dark-green transition-colors">
                        Agendar Agora
                    </button>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-health-blue rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="ml-3 text-lg font-semibold text-gray-900 dark:text-white">Fila de Espera</h3>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Acompanhe sua posi√ß√£o na fila e previs√£o de atendimento</p>
                    <button onclick="showQueueStatus()" class="w-full bg-health-blue text-white py-2 rounded-md hover:bg-blue-600 transition-colors">
                        Ver Posi√ß√£o
                    </button>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                        </div>
                        <h3 class="ml-3 text-lg font-semibold text-gray-900 dark:text-white">Hist√≥rico M√©dico</h3>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Acesse seu hist√≥rico de consultas e exames</p>
                    <button onclick="showSection('profile')" class="w-full bg-purple-500 text-white py-2 rounded-md hover:bg-purple-600 transition-colors">
                        Ver Hist√≥rico
                    </button>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Atividades Recentes</h3>
                <div class="space-y-3">
                    <div class="flex items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white">Consulta agendada para 15/01/2024</p>
                            <p class="text-xs text-gray-600 dark:text-gray-400">Cardiologia - Dr. Carlos Silva</p>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-500">2 dias</span>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 dark:text-white">Resultado de exame dispon√≠vel</p>
                            <p class="text-xs text-gray-600 dark:text-gray-400">Hemograma completo</p>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-500">1 semana</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Medical Portal Section -->
        <section id="medicalSection" class="section hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Portal M√©dico - Prontu√°rio Eletr√¥nico</h2>
                <div class="flex gap-3">
                    <button onclick="searchPatient()" class="bg-health-blue text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">
                        üîç Buscar Paciente
                    </button>
                </div>
            </div>

            <!-- Doctor Info -->
            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-lg p-6 mb-6">
                <div class="flex items-center">
                    <div class="w-16 h-16 bg-health-blue rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Dra. Ana Costa</h3>
                        <p class="text-gray-600 dark:text-gray-400">Cl√≠nica Geral - CRM 123456</p>
                        <p class="text-sm text-gray-500 dark:text-gray-500">UBS Centro ‚Ä¢ Conectado √†s 14:32</p>
                    </div>
                    <div class="ml-auto text-right">
                        <div class="text-lg font-semibold text-health-green">8</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Consultas Hoje</div>
                    </div>
                </div>
            </div>

            <!-- Patient Record -->
            <div id="patientRecord" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Patient Info -->
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                            <div class="flex justify-between items-start mb-4">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Prontu√°rio do Paciente</h3>
                                <button onclick="closePacientRecord()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div>
                                    <span class="text-sm text-gray-500 dark:text-gray-400">Nome:</span>
                                    <p class="font-medium text-gray-900 dark:text-white" id="patientName">Jo√£o da Silva Santos</p>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500 dark:text-gray-400">CPF:</span>
                                    <p class="font-medium text-gray-900 dark:text-white" id="currentPatientCPF">123.456.789-00</p>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500 dark:text-gray-400">Cart√£o SUS:</span>
                                    <p class="font-medium text-gray-900 dark:text-white" id="patientSUS">123 4567 8901 2345</p>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500 dark:text-gray-400">Idade:</span>
                                    <p class="font-medium text-gray-900 dark:text-white" id="patientAge">43 anos</p>
                                </div>
                            </div>
                        </div>

                        <!-- Medical History -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Hist√≥rico M√©dico Completo</h3>
                            <div class="space-y-4" id="fullMedicalHistory">
                                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                                    <div class="flex justify-between items-start mb-2">
                                        <h4 class="font-medium text-gray-900 dark:text-white">Consulta Cardiologia</h4>
                                        <span class="text-xs text-gray-500 dark:text-gray-500">28/12/2023</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">Dr. Carlos Silva - UBS Centro</p>
                                    <p class="text-sm text-gray-700 dark:text-gray-300"><strong>Diagn√≥stico:</strong> Hipertens√£o arterial controlada</p>
                                    <div class="mt-2">
                                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Consulta Realizada</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Patient Sidebar -->
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Informa√ß√µes M√©dicas</h3>
                            <div class="space-y-3">
                                <div>
                                    <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Alergias:</span>
                                    <p class="text-sm text-red-600 dark:text-red-400">‚ö†Ô∏è Penicilina, Dipirona</p>
                                </div>
                                <div>
                                    <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Comorbidades:</span>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Hipertens√£o arterial</p>
                                </div>
                                <div>
                                    <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Grupo Sangu√≠neo:</span>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">O+</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">A√ß√µes R√°pidas</h3>
                            <div class="space-y-2">
                                <button onclick="requestExam()" class="w-full bg-health-blue text-white py-2 rounded-md hover:bg-blue-600 transition-colors text-sm">
                                    üî¨ Solicitar Exame
                                </button>
                                <button onclick="addToQueue()" class="w-full bg-purple-500 text-white py-2 rounded-md hover:bg-purple-600 transition-colors text-sm">
                                    üìã Adicionar √† Fila
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Today's Appointments -->
            <div id="todayAppointments" class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Agenda de Hoje</h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div>
                            <h4 class="font-medium text-gray-900 dark:text-white">Jo√£o da Silva Santos</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Consulta de rotina</p>
                        </div>
                        <div class="text-right">
                            <p class="font-medium text-gray-900 dark:text-white">09:30</p>
                            <button onclick="openPatientRecord('joao-silva')" class="text-health-blue hover:text-blue-600 text-sm">
                                Abrir Prontu√°rio
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div>
                            <h4 class="font-medium text-gray-900 dark:text-white">Maria Oliveira</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Retorno</p>
                        </div>
                        <div class="text-right">
                            <p class="font-medium text-gray-900 dark:text-white">10:30</p>
                            <button onclick="openPatientRecord('maria-oliveira')" class="text-health-blue hover:text-blue-600 text-sm">
                                Abrir Prontu√°rio
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Appointments Section -->
        <section id="appointmentsSection" class="section hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Minhas Consultas</h2>
                <button onclick="showNewAppointment()" class="bg-health-green text-white px-4 py-2 rounded-md hover:bg-health-dark-green transition-colors">
                    + Nova Consulta
                </button>
            </div>

            <!-- Filters -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-6">
                <div class="flex flex-wrap gap-4">
                    <select class="px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option>Todas as consultas</option>
                        <option>Agendadas</option>
                        <option>Realizadas</option>
                        <option>Canceladas</option>
                    </select>
                    
                    <select class="px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option>Todas as especialidades</option>
                        <option>Cardiologia</option>
                        <option>Dermatologia</option>
                        <option>Cl√≠nica Geral</option>
                    </select>
                </div>
            </div>

            <!-- Scheduled Appointments -->
            <div class="space-y-4" id="appointmentsList">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Cardiologia - Dr. Carlos Silva</h3>
                            <p class="text-gray-600 dark:text-gray-400">UBS Centro</p>
                        </div>
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium">Confirmado</span>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                        <div>
                            <span class="text-gray-500 dark:text-gray-400">Data:</span>
                            <p class="font-medium text-gray-900 dark:text-white">15/01/2024</p>
                        </div>
                        <div>
                            <span class="text-gray-500 dark:text-gray-400">Hor√°rio:</span>
                            <p class="font-medium text-gray-900 dark:text-white">09:30</p>
                        </div>
                        <div>
                            <span class="text-gray-500 dark:text-gray-400">Protocolo:</span>
                            <p class="font-medium text-gray-900 dark:text-white">#2024001234</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="rescheduleAppointment('#2024001234')" class="text-health-blue hover:text-blue-600">Remarcar</button>
                            <button onclick="cancelAppointment('#2024001234')" class="text-red-500 hover:text-red-600">Cancelar</button>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Dermatologia - Dr. Pedro Santos</h3>
                            <p class="text-gray-600 dark:text-gray-400">UBS Norte</p>
                        </div>
                        <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium">Aguardando</span>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                        <div>
                            <span class="text-gray-500 dark:text-gray-400">Data:</span>
                            <p class="font-medium text-gray-900 dark:text-white">22/01/2024</p>
                        </div>
                        <div>
                            <span class="text-gray-500 dark:text-gray-400">Hor√°rio:</span>
                            <p class="font-medium text-gray-900 dark:text-white">14:00</p>
                        </div>
                        <div>
                            <span class="text-gray-500 dark:text-gray-400">Protocolo:</span>
                            <p class="font-medium text-gray-900 dark:text-white">#2024001235</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="rescheduleAppointment('#2024001235')" class="text-health-blue hover:text-blue-600">Remarcar</button>
                            <button onclick="cancelAppointment('#2024001235')" class="text-red-500 hover:text-red-600">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profileSection" class="section hidden">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Meu Perfil</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Personal Data -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Dados Pessoais</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Nome Completo</label>
                            <input type="text" value="Jo√£o da Silva Santos" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">CPF</label>
                            <input type="text" value="123.456.789-00" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                            <input type="email" value="joao.silva@email.com" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Telefone</label>
                            <input type="tel" value="(11) 99999-9999" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        </div>
                    </div>
                    <button onclick="saveProfile()" class="mt-4 bg-health-green text-white px-4 py-2 rounded-md hover:bg-health-dark-green transition-colors">
                        Salvar Altera√ß√µes
                    </button>
                </div>

                <!-- Medical Information -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Informa√ß√µes M√©dicas</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Cart√£o SUS</label>
                            <input type="text" value="123 4567 8901 2345" class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Grupo Sangu√≠neo</label>
                            <select class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Alergias</label>
                            <textarea rows="3" placeholder="Informe suas alergias..." class="w-full px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">Penicilina, Dipirona</textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Medical History -->
            <div class="mt-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Hist√≥rico de Consultas</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b border-gray-200 dark:border-gray-700">
                                <th class="text-left py-2">Data</th>
                                <th class="text-left py-2">Especialidade</th>
                                <th class="text-left py-2">M√©dico</th>
                                <th class="text-left py-2">Status</th>
                                <th class="text-left py-2">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-100 dark:border-gray-700">
                                <td class="py-2">28/12/2023</td>
                                <td class="py-2">Cardiologia</td>
                                <td class="py-2">Dr. Carlos Silva</td>
                                <td class="py-2"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Realizada</span></td>
                                <td class="py-2">
                                    <button onclick="viewConsultationDetails('cons_001')" class="text-health-blue hover:text-blue-600">Ver detalhes</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Health Unit Section -->
        <section id="health_unitSection" class="section hidden">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Portal da Unidade de Sa√∫de - UBS Centro</h2>
            
            <!-- Unit Info -->
            <div class="bg-gradient-to-r from-teal-50 to-cyan-50 dark:from-gray-800 dark:to-gray-700 rounded-lg p-6 mb-6">
                <div class="flex items-center">
                    <div class="w-16 h-16 bg-teal-500 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">UBS Centro</h3>
                        <p class="text-gray-600 dark:text-gray-400">Unidade B√°sica de Sa√∫de</p>
                        <p class="text-sm text-gray-500 dark:text-gray-500">Rua das Flores, 123 - Centro ‚Ä¢ CNES: 2582465</p>
                    </div>
                    <div class="ml-auto grid grid-cols-2 gap-4 text-center">
                        <div>
                            <div class="text-lg font-semibold text-teal-600">95%</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Ocupa√ß√£o</div>
                        </div>
                        <div>
                            <div class="text-lg font-semibold text-health-green">12</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">M√©dicos</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-health-green rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">89</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Consultas Hoje</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-health-blue rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">47</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Fila de Espera</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">2,145</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Pacientes Cadastrados</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">156</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Exames Pendentes</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Gerenciar Agenda</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Controlar hor√°rios e disponibilidade dos m√©dicos</p>
                    <button onclick="manageSchedule()" class="w-full bg-health-green text-white py-2 rounded-md hover:bg-health-dark-green transition-colors">
                        Gerenciar Agenda
                    </button>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Fila de Atendimento</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Organizar e gerenciar filas de espera</p>
                    <button onclick="manageQueue()" class="w-full bg-health-blue text-white py-2 rounded-md hover:bg-blue-600 transition-colors">
                        Gerenciar Fila
                    </button>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Relat√≥rios da Unidade</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Gerar relat√≥rios operacionais e estat√≠sticas</p>
                    <button onclick="unitReports()" class="w-full bg-purple-500 text-white py-2 rounded-md hover:bg-purple-600 transition-colors">
                        Gerar Relat√≥rios
                    </button>
                </div>
            </div>

            <!-- Today's Activity -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Atividades de Hoje</h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                            <div>
                                <p class="text-sm font-medium text-gray-900 dark:text-white">Dr. Carlos Silva - Cardiologia</p>
                                <p class="text-xs text-gray-600 dark:text-gray-400">8 consultas agendadas</p>
                            </div>
                        </div>
                        <span class="text-xs text-green-600 dark:text-green-400 font-medium">Ativo</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                            <div>
                                <p class="text-sm font-medium text-gray-900 dark:text-white">Dra. Ana Costa - Cl√≠nica Geral</p>
                                <p class="text-xs text-gray-600 dark:text-gray-400">12 consultas agendadas</p>
                            </div>
                        </div>
                        <span class="text-xs text-yellow-600 dark:text-yellow-400 font-medium">Ocupado</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-2 h-2 bg-red-500 rounded-full mr-3"></div>
                            <div>
                                <p class="text-sm font-medium text-gray-900 dark:text-white">Sistema de Exames</p>
                                <p class="text-xs text-gray-600 dark:text-gray-400">Manuten√ß√£o programada √†s 18:00</p>
                            </div>
                        </div>
                        <span class="text-xs text-red-600 dark:text-red-400 font-medium">Alerta</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="adminSection" class="section hidden">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Painel Administrativo</h2>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-health-green rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">1,247</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Consultas Agendadas</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-health-blue rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">3,842</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Pacientes Ativos</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">127</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">M√©dicos Ativos</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">89%</h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">Taxa de Ocupa√ß√£o</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Gerenciar M√©dicos</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Adicionar, editar ou remover m√©dicos do sistema</p>
                    <button onclick="manageDoctors()" class="w-full bg-health-green text-white py-2 rounded-md hover:bg-health-dark-green transition-colors">
                        Gerenciar
                    </button>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Relat√≥rios</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Gerar relat√≥rios de consultas e estat√≠sticas</p>
                    <button onclick="generateReports()" class="w-full bg-health-blue text-white py-2 rounded-md hover:bg-blue-600 transition-colors">
                        Gerar Relat√≥rios
                    </button>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Configura√ß√µes</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Configurar hor√°rios, especialidades e unidades</p>
                    <button onclick="systemSettings()" class="w-full bg-purple-500 text-white py-2 rounded-md hover:bg-purple-600 transition-colors">
                        Configurar
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Notifications -->
    <div id="notifications" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <script>
        // Dark mode setup
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // User Management System
        let currentUser = null;
        
        const userProfiles = {
            patient: {
                name: 'Jo√£o da Silva Santos',
                type: 'Paciente',
                icon: 'üë§',
                color: 'blue',
                navigation: [
                    { id: 'home', label: 'In√≠cio', icon: 'üè†' },
                    { id: 'appointments', label: 'Consultas', icon: 'üìÖ' },
                    { id: 'profile', label: 'Perfil', icon: 'üë§' }
                ]
            },
            doctor: {
                name: 'Dra. Ana Costa',
                type: 'M√©dico',
                icon: 'üë®‚Äç‚öïÔ∏è',
                color: 'green',
                navigation: [
                    { id: 'medical', label: 'Prontu√°rio', icon: 'üìã' },
                    { id: 'appointments', label: 'Agenda', icon: 'üìÖ' },
                    { id: 'profile', label: 'Perfil', icon: 'üë§' }
                ]
            },
            health_unit: {
                name: 'UBS Centro',
                type: 'Unidade de Sa√∫de',
                icon: 'üè•',
                color: 'teal',
                navigation: [
                    { id: 'health_unit', label: 'Dashboard', icon: 'üè•' },
                    { id: 'appointments', label: 'Consultas', icon: 'üìÖ' },
                    { id: 'profile', label: 'Configura√ß√µes', icon: '‚öôÔ∏è' }
                ]
            },
            admin: {
                name: 'Carlos Admin',
                type: 'Administrador',
                icon: 'üë•',
                color: 'purple',
                navigation: [
                    { id: 'admin', label: 'Dashboard', icon: 'üìä' },
                    { id: 'appointments', label: 'Consultas', icon: 'üìÖ' },
                    { id: 'profile', label: 'Configura√ß√µes', icon: '‚öôÔ∏è' }
                ]
            }
        };

        // Login Functions
        function performLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const userType = document.getElementById('userType').value;
            
            if (!email || !password || !userType) {
                showNotification('‚ö†Ô∏è Por favor, preencha todos os campos.', 'error');
                return;
            }
            
            loginUser(userType);
        }

        function quickLogin(userType) {
            loginUser(userType);
        }

        function loginUser(userType) {
            if (!userProfiles[userType]) {
                showNotification('‚ùå Tipo de usu√°rio inv√°lido.', 'error');
                return;
            }
            
            currentUser = userProfiles[userType];
            
            // Hide login screen
            document.getElementById('loginScreen').classList.add('hidden');
            
            // Show main interface
            document.getElementById('mainHeader').classList.remove('hidden');
            document.getElementById('mainContent').classList.remove('hidden');
            
            // Update user info
            document.getElementById('currentUserName').textContent = currentUser.name;
            document.getElementById('currentUserType').textContent = currentUser.type;
            document.getElementById('currentUserType').className = `px-2 py-1 bg-${currentUser.color}-100 text-${currentUser.color}-800 text-xs rounded-full`;
            document.getElementById('userInfo').textContent = `Logado como ${currentUser.type}`;
            
            // Setup navigation
            setupNavigation();
            
            // Show appropriate home section
            if (userType === 'doctor') {
                showSection('medical');
            } else if (userType === 'admin') {
                showSection('admin');
            } else if (userType === 'health_unit') {
                showSection('health_unit');
            } else {
                showSection('home');
            }
            
            showNotification(`‚úÖ Bem-vindo(a), ${currentUser.name}!`, 'success');
        }

        function setupNavigation() {
            const mainNav = document.getElementById('mainNavigation');
            
            // Clear existing navigation
            mainNav.innerHTML = '';
            
            // Add navigation items based on user type
            currentUser.navigation.forEach(item => {
                const navButton = document.createElement('button');
                navButton.onclick = () => showSection(item.id);
                navButton.className = 'nav-btn text-gray-700 dark:text-gray-300 hover:text-health-green transition-colors';
                navButton.innerHTML = `${item.icon} ${item.label}`;
                mainNav.appendChild(navButton);
            });
        }

        function logout() {
            currentUser = null;
            
            // Show login screen
            document.getElementById('loginScreen').classList.remove('hidden');
            
            // Hide main interface
            document.getElementById('mainHeader').classList.add('hidden');
            document.getElementById('mainContent').classList.add('hidden');
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            showNotification('üëã Logout realizado com sucesso!', 'info');
        }

        // Section navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
                targetSection.classList.add('fade-in');
            }
        }

        // Medical Portal Functions
        function searchPatient() {
            showNotification('üîç Paciente encontrado! Abrindo prontu√°rio...', 'success');
            openPatientRecord('joao-silva');
        }

        function openPatientRecord(patientId) {
            // Hide agenda and show patient record
            document.getElementById('todayAppointments').classList.add('hidden');
            document.getElementById('patientRecord').classList.remove('hidden');
            document.getElementById('patientRecord').classList.add('fade-in');
            
            showNotification('üìã Prontu√°rio carregado com sucesso!', 'info');
        }

        function closePacientRecord() {
            document.getElementById('patientRecord').classList.add('hidden');
            document.getElementById('todayAppointments').classList.remove('hidden');
        }

        function requestExam() {
            showNotification('üî¨ Solicita√ß√£o de exames ser√° implementada!', 'info');
        }

        function addToQueue() {
            showNotification('üìã Paciente adicionado √† fila de atendimento!', 'success');
        }

        // Appointment Functions
        function showNewAppointment() {
            showNotification('üìÖ Funcionalidade de agendamento em desenvolvimento!', 'info');
        }

        function rescheduleAppointment(appointmentId) {
            showNotification(`üìÖ Funcionalidade para remarcar consulta ${appointmentId} em desenvolvimento!`, 'info');
        }

        function cancelAppointment(appointmentId) {
            if (confirm('Tem certeza que deseja cancelar esta consulta?')) {
                showNotification(`‚ùå Consulta ${appointmentId} cancelada com sucesso!`, 'success');
            }
        }

        function showQueueStatus() {
            showNotification('üìç Voc√™ est√° em 3¬∫ lugar na fila de Dermatologia. Previs√£o: 22/01/2024', 'info');
        }

        // Profile Functions
        function saveProfile() {
            showNotification('‚úÖ Perfil atualizado com sucesso!', 'success');
        }

        function viewConsultationDetails(consultationId) {
            showNotification(`üìã Abrindo detalhes da consulta ${consultationId}...`, 'info');
        }

        // Admin Functions
        function manageDoctors() {
            showNotification('üë®‚Äç‚öïÔ∏è M√≥dulo de gerenciamento de m√©dicos em desenvolvimento!', 'info');
        }

        function generateReports() {
            showNotification('üìä Gerando relat√≥rios do sistema...', 'info');
        }

        function systemSettings() {
            showNotification('‚öôÔ∏è Painel de configura√ß√µes em desenvolvimento!', 'info');
        }

        // Health Unit Functions
        function manageSchedule() {
            showScheduleManager();
        }

        function showScheduleManager() {
            const modal = document.createElement('div');
            modal.id = 'scheduleModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-6xl w-full max-h-[95vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-center">
                            <h2 class="text-2xl font-bold text-gray-900 dark:text-white">üìÖ Gerenciar Agenda - UBS Centro</h2>
                            <button onclick="closeScheduleManager()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">
                            Controle hor√°rios e disponibilidade dos m√©dicos da unidade
                        </p>
                    </div>

                    <div class="p-6">
                        <!-- Date and Actions -->
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                            <div class="flex items-center gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Data:</label>
                                    <input type="date" id="scheduleDate" value="${new Date().toISOString().split('T')[0]}" 
                                           class="px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Especialidade:</label>
                                    <select id="scheduleSpecialty" class="px-3 py-2 text-base border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-health-green dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                        <option value="">Todas</option>
                                        <option value="clinica-geral">Cl√≠nica Geral</option>
                                        <option value="cardiologia">Cardiologia</option>
                                        <option value="dermatologia">Dermatologia</option>
                                        <option value="pediatria">Pediatria</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="addScheduleSlot()" class="bg-health-green text-white px-4 py-2 rounded-md hover:bg-health-dark-green transition-colors">
                                    + Adicionar Hor√°rio
                                </button>
                                <button onclick="importSchedule()" class="bg-health-blue text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">
                                    üì• Importar
                                </button>
                            </div>
                        </div>

                        <!-- Schedule Grid -->
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Agenda do Dia</h3>
                            
                            <!-- Time slots header -->
                            <div class="grid grid-cols-8 gap-2 mb-4">
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm">M√©dico</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">08:00</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">10:00</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">12:00</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">14:00</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">16:00</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">18:00</div>
                                <div class="font-medium text-gray-700 dark:text-gray-300 text-sm text-center">A√ß√µes</div>
                            </div>

                            <!-- Doctor schedules -->
                            <div id="scheduleGrid" class="space-y-2">
                                <!-- Schedule rows will be populated here -->
                            </div>
                        </div>

                        <!-- Schedule Summary -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">üìä Resumo do Dia</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600 dark:text-gray-400">Total de Hor√°rios:</span>
                                        <span class="font-medium text-gray-900 dark:text-white" id="totalSlots">42</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600 dark:text-gray-400">Ocupados:</span>
                                        <span class="font-medium text-green-600">35</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600 dark:text-gray-400">Dispon√≠veis:</span>
                                        <span class="font-medium text-health-blue">7</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">üë®‚Äç‚öïÔ∏è M√©dicos Ativos</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span class="text-gray-900 dark:text-white">Dr. Carlos Silva</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span class="text-gray-900 dark:text-white">Dra. Ana Costa</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                                        <span class="text-gray-900 dark:text-white">Dr. Pedro Santos</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">‚ö†Ô∏è Alertas</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-start gap-2">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mt-1"></div>
                                        <span class="text-gray-900 dark:text-white">Dr. Jo√£o ausente hoje</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <div class="w-2 h-2 bg-orange-500 rounded-full mt-1"></div>
                                        <span class="text-gray-900 dark:text-white">Cardiologia com alta demanda</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Load schedule data
            loadScheduleData();
            
            showNotification('üìÖ Agenda carregada com sucesso!', 'success');
        }

        function closeScheduleManager() {
            const modal = document.getElementById('scheduleModal');
            if (modal) {
                modal.remove();
            }
        }

        function loadScheduleData() {
            const scheduleGrid = document.getElementById('scheduleGrid');
            
            const doctors = [
                {
                    id: 'ana-costa',
                    name: 'Dra. Ana Costa',
                    specialty: 'Cl√≠nica Geral',
                    color: 'green',
                    schedule: ['available', 'busy', 'available', 'busy', 'available', 'off']
                },
                {
                    id: 'carlos-silva',
                    name: 'Dr. Carlos Silva',
                    specialty: 'Cardiologia',
                    color: 'blue',
                    schedule: ['busy', 'busy', 'off', 'busy', 'busy', 'available']
                },
                {
                    id: 'pedro-santos',
                    name: 'Dr. Pedro Santos',
                    specialty: 'Dermatologia',
                    color: 'purple',
                    schedule: ['available', 'available', 'busy', 'available', 'off', 'off']
                },
                {
                    id: 'maria-oliveira',
                    name: 'Dra. Maria Oliveira',
                    specialty: 'Pediatria',
                    color: 'pink',
                    schedule: ['busy', 'available', 'busy', 'busy', 'available', 'available']
                }
            ];

            scheduleGrid.innerHTML = doctors.map(doctor => `
                <div class="grid grid-cols-8 gap-2 items-center">
                    <div class="p-2">
                        <div class="font-medium text-gray-900 dark:text-white text-sm">${doctor.name}</div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">${doctor.specialty}</div>
                    </div>
                    ${doctor.schedule.map((status, index) => `
                        <div class="p-1">
                            <button onclick="toggleScheduleSlot('${doctor.id}', ${index})" 
                                    class="w-full h-8 rounded text-xs font-medium transition-colors
                                    ${status === 'available' ? 'bg-green-100 text-green-800 hover:bg-green-200' : 
                                      status === 'busy' ? 'bg-red-100 text-red-800 hover:bg-red-200' : 
                                      'bg-gray-100 text-gray-500 hover:bg-gray-200'} 
                                    dark:${status === 'available' ? 'bg-green-900 text-green-300' : 
                                           status === 'busy' ? 'bg-red-900 text-red-300' : 
                                           'bg-gray-700 text-gray-400'}">
                                ${status === 'available' ? 'Livre' : status === 'busy' ? 'Ocupado' : 'Folga'}
                            </button>
                        </div>
                    `).join('')}
                    <div class="p-1">
                        <button onclick="editDoctorSchedule('${doctor.id}')" 
                                class="w-full bg-health-blue text-white px-2 py-1 rounded text-xs hover:bg-blue-600 transition-colors">
                            Editar
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function toggleScheduleSlot(doctorId, slotIndex) {
            showNotification(`üîÑ Alternando hor√°rio do m√©dico ${doctorId} no slot ${slotIndex + 1}...`, 'info');
            // Here would be the logic to toggle the schedule slot
            setTimeout(() => {
                showNotification('‚úÖ Hor√°rio atualizado com sucesso!', 'success');
                loadScheduleData(); // Reload to show changes
            }, 1000);
        }

        function addScheduleSlot() {
            showNotification('‚ûï Abrindo formul√°rio para adicionar novo hor√°rio...', 'info');
            // This would open a form to add new schedule slots
        }

        function importSchedule() {
            showImportModal();
        }

        function showImportModal() {
            const importModal = document.createElement('div');
            importModal.id = 'importModal';
            importModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            importModal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-center">
                            <h2 class="text-2xl font-bold text-gray-900 dark:text-white">üì• Importar Agenda</h2>
                            <button onclick="closeImportModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">
                            Importe agendas em lote atrav√©s de arquivo CSV ou Excel
                        </p>
                    </div>

                    <div class="p-6">
                        <!-- Import Options -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">
                                <h3 class="font-semibold text-blue-900 dark:text-blue-300 mb-2">üìã Formatos Aceitos</h3>
                                <ul class="text-sm text-blue-800 dark:text-blue-400 space-y-1">
                                    <li>‚Ä¢ Arquivo CSV (.csv)</li>
                                    <li>‚Ä¢ Excel (.xlsx, .xls)</li>
                                    <li>‚Ä¢ Tamanho m√°ximo: 10MB</li>
                                    <li>‚Ä¢ At√© 1000 registros</li>
                                </ul>
                            </div>
                            
                            <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4">
                                <h3 class="font-semibold text-green-900 dark:text-green-300 mb-2">üìä Formato dos Dados</h3>
                                <div class="text-sm text-green-800 dark:text-green-400 space-y-1">
                                    <p><strong>Colunas obrigat√≥rias:</strong></p>
                                    <p>‚Ä¢ medico, data, horario, status</p>
                                    <p><strong>Exemplo:</strong></p>
                                    <p class="font-mono text-xs">Dr. Silva,2024-01-15,09:00,disponivel</p>
                                </div>
                            </div>
                        </div>

                        <!-- File Upload Area -->
                        <div class="mb-6">
                            <div id="dropZone" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-health-blue transition-colors cursor-pointer">
                                <div class="flex flex-col items-center">
                                    <svg class="w-12 h-12 text-gray-400 dark:text-gray-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                    </svg>
                                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">Clique ou arraste o arquivo aqui</h3>
                                    <p class="text-gray-600 dark:text-gray-400 mb-4">Formatos aceitos: CSV, Excel</p>
                                    <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" class="hidden" onchange="handleFileSelect(event)">
                                    <button onclick="document.getElementById('fileInput').click()" class="bg-health-blue text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors">
                                        Selecionar Arquivo
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- File Info -->
                        <div id="fileInfo" class="hidden mb-6">
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <svg class="w-8 h-8 text-green-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        <div>
                                            <p class="font-medium text-gray-900 dark:text-white" id="fileName">arquivo.csv</p>
                                            <p class="text-sm text-gray-600 dark:text-gray-400" id="fileSize">2.5 KB</p>
                                        </div>
                                    </div>
                                    <button onclick="removeFile()" class="text-red-500 hover:text-red-700">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Import Options -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">‚öôÔ∏è Op√ß√µes de Importa√ß√£o</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="overwriteExisting" class="rounded border-gray-300 text-health-green focus:ring-health-green" checked>
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Sobrescrever agendas existentes</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="validateData" class="rounded border-gray-300 text-health-green focus:ring-health-green" checked>
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Validar dados antes da importa√ß√£o</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="sendNotifications" class="rounded border-gray-300 text-health-green focus:ring-health-green">
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Notificar m√©dicos sobre mudan√ßas</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="backupBeforeImport" class="rounded border-gray-300 text-health-green focus:ring-health-green" checked>
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Criar backup antes da importa√ß√£o</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Import Preview -->
                        <div id="importPreview" class="hidden mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">üëÅÔ∏è Pr√©via dos Dados</h3>
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 max-h-64 overflow-y-auto">
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm">
                                        <thead>
                                            <tr class="border-b border-gray-200 dark:border-gray-600">
                                                <th class="text-left py-2">M√©dico</th>
                                                <th class="text-left py-2">Data</th>
                                                <th class="text-left py-2">Hor√°rio</th>
                                                <th class="text-left py-2">Status</th>
                                                <th class="text-left py-2">A√ß√£o</th>
                                            </tr>
                                        </thead>
                                        <tbody id="previewTableBody">
                                            <!-- Preview data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Bar -->
                        <div id="importProgress" class="hidden mb-6">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Progresso da Importa√ß√£o</span>
                                <span class="text-sm text-gray-600 dark:text-gray-400" id="progressText">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div id="progressBar" class="bg-health-green h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex justify-end gap-3">
                            <button onclick="closeImportModal()" class="px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                                Cancelar
                            </button>
                            <button onclick="downloadTemplate()" class="px-4 py-2 bg-purple-500 text-white rounded-md hover:bg-purple-600 transition-colors">
                                üì• Baixar Modelo
                            </button>
                            <button onclick="processImport()" id="importButton" class="px-4 py-2 bg-health-green text-white rounded-md hover:bg-health-dark-green transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                üöÄ Importar Dados
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(importModal);
            
            // Setup drag and drop
            setupDragAndDrop();
            
            showNotification('üì• Modal de importa√ß√£o aberto!', 'info');
        }

        function closeImportModal() {
            const modal = document.getElementById('importModal');
            if (modal) {
                modal.remove();
            }
        }

        function setupDragAndDrop() {
            const dropZone = document.getElementById('dropZone');
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('border-health-blue', 'bg-blue-50', 'dark:bg-blue-900/20');
            });
            
            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-health-blue', 'bg-blue-50', 'dark:bg-blue-900/20');
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('border-health-blue', 'bg-blue-50', 'dark:bg-blue-900/20');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            // Validate file type
            const validTypes = ['.csv', '.xlsx', '.xls'];
            const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
            
            if (!validTypes.includes(fileExtension)) {
                showNotification('‚ùå Formato de arquivo n√£o suportado! Use CSV ou Excel.', 'error');
                return;
            }
            
            // Validate file size (10MB max)
            if (file.size > 10 * 1024 * 1024) {
                showNotification('‚ùå Arquivo muito grande! M√°ximo 10MB.', 'error');
                return;
            }
            
            // Show file info
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('fileInfo').classList.remove('hidden');
            document.getElementById('importButton').disabled = false;
            
            // Simulate file parsing and show preview
            setTimeout(() => {
                showImportPreview();
            }, 1000);
            
            showNotification('‚úÖ Arquivo carregado com sucesso!', 'success');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showImportPreview() {
            // Simulate parsed data preview
            const sampleData = [
                { medico: 'Dr. Carlos Silva', data: '2024-01-15', horario: '09:00', status: 'disponivel', acao: '‚úÖ V√°lido' },
                { medico: 'Dra. Ana Costa', data: '2024-01-15', horario: '10:00', status: 'ocupado', acao: '‚úÖ V√°lido' },
                { medico: 'Dr. Pedro Santos', data: '2024-01-15', horario: '14:00', status: 'disponivel', acao: '‚úÖ V√°lido' },
                { medico: 'Dra. Maria Oliveira', data: '2024-01-16', horario: '08:00', status: 'folga', acao: '‚ö†Ô∏è Revisar' },
                { medico: 'Dr. Jo√£o Invalid', data: '2024-01-16', horario: '25:00', status: 'erro', acao: '‚ùå Erro' }
            ];
            
            const tbody = document.getElementById('previewTableBody');
            tbody.innerHTML = sampleData.map(row => `
                <tr class="border-b border-gray-100 dark:border-gray-600">
                    <td class="py-2">${row.medico}</td>
                    <td class="py-2">${row.data}</td>
                    <td class="py-2">${row.horario}</td>
                    <td class="py-2">
                        <span class="px-2 py-1 rounded-full text-xs ${
                            row.status === 'disponivel' ? 'bg-green-100 text-green-800' :
                            row.status === 'ocupado' ? 'bg-red-100 text-red-800' :
                            row.status === 'folga' ? 'bg-gray-100 text-gray-800' :
                            'bg-red-100 text-red-800'
                        }">${row.status}</span>
                    </td>
                    <td class="py-2">${row.acao}</td>
                </tr>
            `).join('');
            
            document.getElementById('importPreview').classList.remove('hidden');
            showNotification('üëÅÔ∏è Pr√©via dos dados carregada!', 'info');
        }

        function removeFile() {
            document.getElementById('fileInfo').classList.add('hidden');
            document.getElementById('importPreview').classList.add('hidden');
            document.getElementById('importButton').disabled = true;
            document.getElementById('fileInput').value = '';
            showNotification('üóëÔ∏è Arquivo removido!', 'info');
        }

        function downloadTemplate() {
            // Create CSV template
            const template = `medico,data,horario,status
Dr. Carlos Silva,2024-01-15,09:00,disponivel
Dra. Ana Costa,2024-01-15,10:00,ocupado
Dr. Pedro Santos,2024-01-15,14:00,disponivel
Dra. Maria Oliveira,2024-01-16,08:00,folga`;
            
            const blob = new Blob([template], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'modelo_agenda_ubs.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('üì• Modelo baixado com sucesso!', 'success');
        }

        function processImport() {
            const overwrite = document.getElementById('overwriteExisting').checked;
            const validate = document.getElementById('validateData').checked;
            const notify = document.getElementById('sendNotifications').checked;
            const backup = document.getElementById('backupBeforeImport').checked;
            
            // Show progress bar
            document.getElementById('importProgress').classList.remove('hidden');
            document.getElementById('importButton').disabled = true;
            
            let progress = 0;
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            const interval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress > 100) progress = 100;
                
                progressBar.style.width = progress + '%';
                progressText.textContent = Math.round(progress) + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    // Simulate completion
                    setTimeout(() => {
                        showNotification('üéâ Importa√ß√£o conclu√≠da com sucesso!', 'success');
                        showImportResults();
                    }, 500);
                }
            }, 300);
            
            showNotification('üöÄ Iniciando importa√ß√£o...', 'info');
        }

        function showImportResults() {
            const resultsModal = document.createElement('div');
            resultsModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            resultsModal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">üìä Resultado da Importa√ß√£o</h2>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-green-600">127</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Importados</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-blue-600">15</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Atualizados</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-yellow-600">3</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Avisos</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-red-600">2</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Erros</div>
                            </div>
                        </div>
                        
                        <div class="space-y-3 mb-6">
                            <div class="flex items-center text-sm">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                                <span class="text-gray-700 dark:text-gray-300">127 agendamentos importados com sucesso</span>
                            </div>
                            <div class="flex items-center text-sm">
                                <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                                <span class="text-gray-700 dark:text-gray-300">15 agendamentos atualizados</span>
                            </div>
                            <div class="flex items-center text-sm">
                                <span class="w-2 h-2 bg-yellow-500 rounded-full mr-2"></span>
                                <span class="text-gray-700 dark:text-gray-300">3 registros com avisos (hor√°rios duplicados)</span>
                            </div>
                            <div class="flex items-center text-sm">
                                <span class="w-2 h-2 bg-red-500 rounded-full mr-2"></span>
                                <span class="text-gray-700 dark:text-gray-300">2 registros com erro (m√©dico n√£o encontrado)</span>
                            </div>
                        </div>
                        
                        <div class="flex justify-end gap-3">
                            <button onclick="this.parentElement.parentElement.parentElement.parentElement.remove(); closeImportModal(); loadScheduleData();" class="px-4 py-2 bg-health-green text-white rounded-md hover:bg-health-dark-green transition-colors">
                                ‚úÖ Concluir e Atualizar Agenda
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(resultsModal);
        }

        function editDoctorSchedule(doctorId) {
            showNotification(`‚úèÔ∏è Editando agenda completa do m√©dico ${doctorId}...`, 'info');
            // This would open a detailed edit form for the doctor's schedule
        }

        function manageQueue() {
            showNotification('üìã Sistema de gerenciamento de filas em desenvolvimento!', 'info');
        }

        function unitReports() {
            showNotification('üìä Gerando relat√≥rios da unidade de sa√∫de...', 'info');
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${getNotificationClasses(type)} p-4 rounded-lg shadow-lg max-w-md mb-3`;
            
            notification.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-shrink-0 mr-3">
                        ${getNotificationIcon(type)}
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-3 text-white hover:text-gray-200 flex-shrink-0">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            `;
            
            document.getElementById('notifications').appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        function getNotificationClasses(type) {
            const classes = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                warning: 'bg-yellow-500 text-white',
                info: 'bg-blue-500 text-white'
            };
            return classes[type] || classes.info;
        }

        function getNotificationIcon(type) {
            const icons = {
                success: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>',
                error: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
                warning: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>',
                info: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>'
            };
            return icons[type] || icons.info;
        }
    </script>
</body>
</html>
